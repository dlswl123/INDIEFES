<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="art">
	<!-- 앨범정보입력 -->
	<insert id="insert">
		insert into art_info (art_number, art_genre, user_id, team_number,art_title,art_cover,art_pr)
		values (seq_art.nextval,#{art_genre},#{user_id},#{team_number},#{art_title},#{art_cover},#{art_pr})
	</insert>
	
	<insert id="teamInsert">
		insert into indie_team (team_number, art_team)
		values (seq_team.nextval,#{art_team})
	</insert>
	<insert id="memberInsert">
	insert into team_member (member_number, team_number,user_id,team_level)
	<if test = "team_level == 0">
		values (seq_member.nextval,seq_team.currval,#{user_id},#{team_level})
	</if>
	<if test = "team_level == 1">
		values (seq_member.nextval,#{team_number},#{user_id},#{team_level})
	</if>
	</insert>
	
<!-- 	앨범정보 읽기 -->
	<select id="art_read" resultType="ArtInfoVo">
		select * 
		from art_info
		where team_number = (select team_number
							 from art_info
							 where user_id = #{user_id}
							 group by team_number)
		 and art_number = #{art_number}
	</select>
	
<!-- 	앨범 노래 읽기 -->
	<select id="music_read" resultType="MusicInfoVo">
		select *
		from music_info
		where art_number = (select art_number
							from art_info
							where art_number = #{art_number})
	</select>
	
</mapper>